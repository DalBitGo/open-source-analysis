# Gemini 오픈소스 분석 가이드

> 이 문서는 Gemini에게 오픈소스 프로젝트를 "문제 → 고민 → 해결" 관점으로 분석시키기 위한 프롬프트입니다.

---

## 📋 사용 방법

### 1단계: 프로젝트 구조 파악 및 핵심 파일 선정

Gemini에게 다음 프롬프트를 전달:

```
나는 오픈소스 프로젝트를 "문제 → 고민 → 해결" 관점으로 분석하려고 합니다.

# 작업 1: 핵심 파일 목록 작성

[프로젝트명] 프로젝트의 전체 구조를 파악하고,
아키텍처 관점에서 **분석해야 할 핵심 파일 전체 목록**을 작성해주세요.

## 선택 기준:
- ✅ 프로젝트의 핵심 기능을 담당하는 파일
- ✅ 아키텍처 설계가 잘 드러나는 파일
- ✅ 실무에서 배울 점이 많은 파일
- ✅ 100줄 이상의 의미있는 로직이 있는 파일
- ❌ 설정 파일, 유틸리티, 테스트 파일은 제외
- ❌ 2000줄 이상의 너무 큰 파일은 분할 고려

## 출력 형식:
분석 대상 파일 목록:
1. `파일경로/filename.py` - 역할 한 줄 설명 (약 XXX lines)
2. `파일경로/filename2.py` - 역할 한 줄 설명 (약 XXX lines)
3. ...

총 X개 파일 선정

---

# 작업 2: 첫 번째 파일 분석 시작

위에서 선택한 **첫 번째 파일**을 분석해주세요.

## 📖 분석 방법론

반드시 첨부된 파일들을 참고하세요:
1. **ANALYSIS_METHODOLOGY.md** - 분석 방법론 (정확히 따라야 함)
2. **aiokafka/analysis-v2/conn.py.md** - 분석 예시 1 (형식 참고)
3. **aiokafka/analysis-v2/client.py.md** - 분석 예시 2 (형식 참고)
4. **aiokafka/analysis-v2/cluster.py.md** - 분석 예시 3 (형식 참고)

[ANALYSIS_METHODOLOGY.md 파일 내용 첨부]
[conn.py.md 파일 내용 첨부]
[client.py.md 파일 내용 첨부]
[cluster.py.md 파일 내용 첨부]

## 필수 포함 섹션 (위 예시와 동일한 구조):

### 1. 📋 파일 개요
- 파일 정보 (경로, 줄 수, 주요 클래스)
- 핵심 역할 (한 문장)
- 누가 사용하는가?

### 2. 해결하는 핵심 문제들
각 문제마다 다음 구조로:

**문제**
- 어떤 문제를 해결하려고 하는가?
- 문제가 없었다면 어떤 불편함이 있었을까?

**고민했던 선택지**
- 선택지 1: 이름 (장점/단점/왜 안 됨)
- 선택지 2: 이름 (장점/단점/왜 안 됨)
- 선택지 3 (최종 선택): 이름 (장점/단점/왜 선택)

**최종 해결책**
- 구조 (코드 예시)
- 핵심 아이디어
- 트레이드오프

### 3. ⭐ 실전 적용 가이드 (필수!)

최소 4개의 가이드를 작성:

**가이드 1: [패턴 이름] 구현하기**
- 상황: 언제 이 패턴을 사용하는가?
- Step 1: 요구사항 정의 (체크리스트)
- Step 2: 기본 구현 (완전한 코드 - 복사해서 바로 쓸 수 있게)
- Step 3: 의사결정 체크리스트 (표 형식)

### 4. ⭐ 안티패턴과 흔한 실수 (필수!)

최소 7개의 실수를 작성:

**실수 1: [실수 이름]**
- ❌ 나쁜 예: (코드)
- 문제: 왜 잘못되었는가? 어떤 문제가 발생하는가?
- ✅ 좋은 예: (코드)

### 5. ⭐ 스케일 고려사항 (필수!)

3개 규모별 전략:

**소규모 (기준 명시)**
- 권장 사항 (✅/⚠️)
- 구현 예시 (코드)
- 모니터링

**중규모 (기준 명시)**
- 권장 사항
- 구현 예시 (코드)
- 모니터링

**대규모 (기준 명시)**
- 권장 사항
- 구현 예시 (고급 코드)
- 모니터링 필수 (Prometheus 스타일 메트릭)

### 6. 배운 점
- 핵심 개념 정리 (7-8개)
- 각 개념마다 "언제 사용?", "적용 가능한 곳" 명시

### 7. 요약
표 형식으로 정리

## 출력 파일명:
`[첫번째파일명].md`

---

분석 완료 후 다음과 같이 응답:
"✅ [파일명].md 분석 완료. 다음 파일을 분석하려면 '다음 파일 분석해줘'라고 요청하세요."
```

---

### 2단계: 나머지 파일 순차 분석

첫 번째 파일 분석이 완료되면:

```
다음 파일 분석해줘
```

Gemini가 두 번째 파일을 동일한 형식으로 분석합니다.

이를 반복하여 모든 핵심 파일을 분석합니다.

---

## 💡 팁

### Gemini에게 첨부해야 할 파일
1. **ANALYSIS_METHODOLOGY.md** (방법론)
2. **aiokafka/analysis-v2/conn.py.md** (예시 1 - 918줄 파일 분석)
3. **aiokafka/analysis-v2/client.py.md** (예시 2 - 701줄 파일 분석)
4. **aiokafka/analysis-v2/cluster.py.md** (예시 3 - 397줄 파일 분석)

### 프로젝트별 추가 정보
- **paperless-ngx**: Django 프로젝트 구조 설명 추가
- **vanna**: RAG/LLM 아키텍처 배경 설명 추가
- **ebook2audiobook**: TTS 파이프라인 배경 설명 추가

### ⚠️ 파일이 너무 클 때 (2000줄 이상) - 중요!

**문제**: 2000줄 이상의 파일을 한번에 분석하면 **Output Token Limit (32000) 에러** 발생 가능

**해결책**: 기능별로 Part를 나눠서 **각각 별도의 .md 파일**로 분석

**예시 - vanna/base.py (2118줄) 분석 방법**:

```
이 파일은 2118줄로 너무 크므로 기능별로 나눠서 분석하겠습니다:

Part 1: RAG Workflow (lines 93-382)
- generate_sql(), extract_sql(), intermediate SQL
- 파일명: base.py-part1-rag.md

Part 2: Abstraction Layer (lines 383-693)
- Abstract methods, Prompt generation, Token budget
- 파일명: base.py-part2-abstraction.md

Part 3: Database Connections (lines 761-1682)
- 11개 DB 연결, Dynamic function binding
- 파일명: base.py-part3-database.md

Part 4: High-level API (lines 1683-2118)
- ask(), train(), Training Plan
- 파일명: base.py-part4-highlevel-api.md

각 Part를 순차적으로 분석한 후, 마지막에 전체 요약 문서를 작성합니다.
```

**진행 순서**:
1. 파일 전체를 읽고 기능별로 Part 나누기 (라인 범위 명시)
2. Part 1 분석 → `파일명-part1-기능명.md` 생성
3. Part 2 분석 → `파일명-part2-기능명.md` 생성
4. Part 3 분석 → `파일명-part3-기능명.md` 생성
5. Part 4 분석 → `파일명-part4-기능명.md` 생성
6. 전체 요약 → `파일명-summary.md` 생성 (선택)

**각 Part별 필수 포함 사항**:
- 해당 Part의 핵심 문제 (문제 → 고민 → 해결)
- 실전 가이드 (최소 2개)
- 안티패턴 (최소 3개)
- 핵심 학습

**주의**: 각 Part는 독립적으로 읽어도 이해 가능하도록 작성

---

## 📊 진행 상황 체크리스트

### paperless-ngx
- [ ] 핵심 파일 목록 작성 완료
- [ ] 파일 1: __________.py 분석 완료
- [ ] 파일 2: __________.py 분석 완료
- [ ] 파일 3: __________.py 분석 완료
- [ ] ...

### vanna
- [ ] 핵심 파일 목록 작성 완료
- [ ] 파일 1: __________.py 분석 완료
- [ ] 파일 2: __________.py 분석 완료
- [ ] ...

### ebook2audiobook
- [ ] 핵심 파일 목록 작성 완료
- [ ] 파일 1: __________.py 분석 완료
- [ ] 파일 2: __________.py 분석 완료
- [ ] ...

---

## ⚠️ 주의사항

1. **방법론 준수**: ANALYSIS_METHODOLOGY.md를 정확히 따라야 함
2. **예시 참고**: aiokafka 3개 파일의 형식을 그대로 따라야 함
3. **완전한 코드**: 실전 가이드의 코드는 복사해서 바로 쓸 수 있어야 함
4. **구체적인 숫자**: 스케일 기준은 명확한 숫자로 (예: "연결 < 10개")
5. **순차 진행**: 한 파일씩 완료 후 다음 파일로

---

## 🎯 기대 결과

각 프로젝트마다:
- `analysis/` 디렉토리 생성
- 핵심 파일별 분석 문서 (*.md)
- 총 5-10개 파일 분석 (프로젝트 규모에 따라)
- 실무에 바로 적용 가능한 패턴 학습
